# Test for a panic provoked by a python_library using a proto_library as a resource.
proto_library(
    name = 'test_proto',
    srcs = ['test.proto'],
)

python_library(
    name = 'proto_lib',
    srcs = ['proto_lib.py'],
    resources = [':test_proto'],
)

python_test(
    name = 'proto_test',
    srcs = ['proto_test.py'],
    deps = [':proto_lib'],
)

python_test(
    name = 'strip_source_test',
    srcs = ['strip_source_test.py'],
    labels = ['manual'],  # only works in stripped configuration
)

# Test that has no actual tests in it. Should still count as a pass.
python_test(
    name = 'empty_test',
    srcs = ['empty_test.py'],
)

# Test that the build rules accept a python_binary that has a rule as the main.
filegroup(
    name = 'rule_main',
    srcs = ['rule_main.py'],
)

python_binary(
    name = 'rule_main_pex',
    main = ':rule_main',
)

sh_test(
    name = 'rule_main_test',
    src = 'rule_main_test.sh',
    data = [':rule_main_pex'],
)
